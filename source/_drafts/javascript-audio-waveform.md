---
title: 컴퓨터는 어떻게 소리를 들을까?
toc: true
widgets:
  - type: toc
    position: right
  - type: category
    position: right
sidebar:
  right:
    sticky: true
tags:
  - Audio
  - Sound Engineering
categories:
  - JavaScript
thumbnail: /2019/07/08/javascript-audio-waveform/thumbnail.jpg
---

이번 포스팅에서는 필자의 예전 직업이었던 `사운드 엔지니어`의 추억을 살려서 한번 오디오에 대한 이론을 설명해볼까 한다. 하지만 설명만 하면 재미가 없기에 오디로 이론을 기반으로 자바스크립트의 `Audio Context API`를 사용하여 간단한 오디오 웨이브폼을 그려보려고 한다.

<!-- more -->

먼저 기본적인 오디오에 관한 지식이 있어야 해당 작업을 좀 수월하게 할 수 있으므로 이론을 최대한 지루하지 않게 설명해보겠다.


## 소리란 무엇일까?
제일 먼저 소리가 무엇인지부터 알아보자! 소리를 딱 한마디로 표현하자만 `진동`이다. 기본적으로 우리가 소리를 듣는다는 것은 이런 순서로 일어난다.

***
1. 어떤 물체가 부르르 진동을 한다.
2. 그 물체 주변에 있는 매질이 그 진동을 전달한다.(일상적인 상황에서는 주로 공기다.)
3. 매질이 우리의 고막을 진동시킨다.
4. 그 진동을 청신경에 전달한다.
5. 뇌가 신호를 받아서 해석한다!
***

이때 `1번` 순서의 물체가 1초에 몇번이나 떨렸는지를 우리는 `헤르츠(herz)`로 표현한다. `10hz`는 1초에 10번 진동을 했다는 의미이고 `1khz`는 1초에 1000번 진동을 했다는 것이다.

이때 이 진동은 자연계에서 발생한 것이기 때문에 `아날로그(Analog)`의 형태로 나타난다. 사실 자연계에서 발생하는 대부분의 거시적인 신호는 아날로그 형태를 가지는데, 예를 들면 빛의 밝기가 변한다거나 바람의 세기가 변한다거나 소리의 크기가 변하는 등의 신호를 말한다.

### 아날로그 신호
`아날로그`는 신호나 자료를 `연속적인` 물리량으로 나타낸 것이다. 연속적이란 것은 무엇일까? 이게 `연속적인 물리량`이라고 하면 뭔가 전문적이고 어려워보이는데 풀어보면 사실 별 거 없다. 여기서 우리가 집중해야할 단어는 물리량 어쩌고가 아닌 `연속적`이다.

<center>
  {% asset_img analog.png 400 %}
  <small>가로 축은 시간, 세로 축은 전압이다. 아날로그 신호는 아무리 쪼개도 끝이 없는 연속성을 가진다</small>
  <br>
</center>

여러분이 여름철 뙤약볕에 앉아 있다고 생각해보자. 이때 바람이 솔솔 불다가 점점 세게 불어서 여러분은 시원함을 느낀다. 이때 포인트는 여러분이 느끼는 시원함은 `점점 증가한다`는 것이다. 계속 덥다고 느끼다가 어느 순간 갑자기 `어? 갑자기 시원해졌어!`라고 느끼지는 않는다.

또 하나 `아날로그`의 대표적인 예는 바로 시간이다. 자 지금 딱 이 시점부터 `1초 후`의 시간까지를 생각해보자.
이 시점부터 `1초 후`의 사이에는 `0.5초 후`도 있을 것이고 `0.25초 후`도 있을 것이며 `0.125초 후`도 있을 것이다. 우리가 지금부터 `1초 후` 사이의 시간을 아무리 쪼개본다 한들 이 쪼개지는 단위에 한계는 없다.
$10^{-10000}$초까지 쪼갠다 해도 우리는 그 시간을 더 쪼갤 수도 있다.

이제 연속적이라는 말이 조금 이해가 되었길 바란다. 사실 우리가 `1990년대 ~ 2000년대 초반`까지 많이 사용하던 `전화기`나 `TV`도 전부 아날로그였다. 지금처럼 디지털로 처리하게 된 건 생각보다 얼마 되지 않았다...라고 하기에는 30년 전이라서 그냥 필자가 늙은 걸로 하겠다.

<center>
  {% asset_img analog-phone.jpg 500 %}
  <small>저 스피커폰 버튼 쓰려다가 실수하면 그대로 전화가 끊긴다. 무슨 뜻인지 이해된다면 그대도 이제 늙은 것이다.</small>
  <br>
</center>

저 당시 우리가 사용하는 전화기는 우리가 말하는 소리의 진동을 그대로 아날로그 전기 신호로 변경해서 상대방의 전화기까지 보내는 것이다. 실전화와 원리는 같다.
대신 실전화는 우리의 소리를 실을 통해서 전달했다면 전화기는 더 멀리 소리를 보내기 위해 소리를 전기 신호로 바꾼 후 보내는 것이다.

이렇게 아날로그는 우리에게 굉장히 친숙한 신호다.

## 컴퓨터가 소리를 듣는 방법
근데 여러분도 알다시피 컴퓨터는 `0`하고 `1`밖에 이해하지 못하는 바보이다. 이 방식을 우리는 `디지털(Digital)`이라고 부른다. 그렇다면 우리가 자연에서 발생한 아날로그 형태인 소리를 컴퓨터가 듣게 해주려면 어떻게 해야할까?
간단하다. 아날로그를 디지털로 바꿔주면 된다. 그럼 지금부터 아날로그를 디지털로 변경하는 `Analog to Digital`에 대해서 알아보자.

아날로그를 디지털로 변경하기 위해서는 몇가지 순서를 거쳐야 한다.

### 샘플링(Sampling)
`샘플링`은 아날로그 신호를 디지털 신호로 바꾸기 위한 첫번째 과정이다. 위에서 설명했듯이 아날로그 신호는 연속적인 신호이기 때문에 컴퓨터가 이 신호를 그대로 이해할 수는 없다.
소리라는 아날로그 신호는 결국 어떠한 전기 신호의 한 종류로 변환되어 처음 컴퓨터에게 주어진다. 이때 컴퓨터는 이 연속적인 전기 신호를 이해할 수 없다.
그래서 컴퓨터는 연속적인 전기 신호를 채집하기 위해 어떤 특정 타이밍을 정해서 `이 타이밍마다 내가 전압을 측정할게!`라고 하는 것이다. 이걸 그림으로 나타내보면 대충 이런 느낌이다.

<center>
  {% asset_img sampling.png 500 %}
  <br>
</center>

위 그림에 나타난 빨간 점이 컴퓨터가 전압을 측정한 타이밍이다. 컴퓨터는 특정 타이밍에 전기 신호를 채집하고 그 값을 저장한다. 빨간 점의 위치를 보면 저 신호는 `[10, 20, 30, 27, 19, 8...]` 뭐 이런 식으로 샘플링이 되었을 것이다.
이때 저 빨간 점을 더 세밀하게, 즉 컴퓨터가 샘플 채집을 하는 간격이 짧을 수록 우리는 원래 신호에 가까운 값을 채집할 수 있다.

<center>
  {% asset_img high-low-sampling.png 500 %}
  <small>신호 내부의 사각형이 컴퓨터가 이해한 신호의 모양이다.</small>
  <br>
</center>

이때 이 신호를 채집하는 간격을 `샘플래이트(Sample Rate)`라고 한다. 당연히 샘플래이트가 높을 수록 소리의 해상도, 즉 음질이 더 좋을 수 밖에 없다.
보통 우리가 듣는 CD의 음질이 `44.1kHz` 정도, 방송이 `48kHz`의 샘플래이트를 가지는데, 이는 약 1초에 `44100`번, `48000`번 샘플을 채집한다는 것이다. 쉽게 말하자면 이 샘플래이트는 소리의 해상도를 표현한다고 생각하면 된다.

#### 44.1kHz? 48kHz?
방금 설명했듯이 CD의 경우 1초에 `44100`번의 샘플을 채취한다. 그 뜻은 1초에 `44100`번 진동하는 파동까지 잡을 수 있다는 뜻이다.
하지만 인간이 들을 수 있는 영역인 가청주파수는 `20hz ~ 20,000hz` 밖에 되지 않는다. 근데 왜 샘플래이트는 `44100hz`, `48000hz`처럼 크게 잡는 것일까?

> 어차피 인간은 1초에 `20000`번 진동하는 소리까지밖에 들을 수 없어서 `44100`번 진동하는 소리를 녹음해도 어차피 들을 수 없는데?

이 질문에 대한 답은 소리의 진동 파형을 보면 대충 이해가 된다.

<center>
  {% asset_img sine-wave.png 500 %}
  <br>
</center>

이게 한 세트이다.




### 양자화
사실 양자역학에 의하면 자연의 많은 부분은 `양자화`되어 있다. 이때 `양자(Quantum)`은 입자나 원자처럼 그런 개념이 아니라 어어어어엄청 작은 단위의 물리량을 표기하는 단위이다.

대표적인게 빛의 입자성을 대표하는 `광자(Photon)`와 `광전효과`이며, 빛이 연속적인 파동인줄 알았는데 사실 비연속적인 빛 알갱이들로 이루어져있다는 걸 의미한다.

하지만 이건 워낙 미세한 부분이라 우리같은 일반인이 생활하는 일반적인 상황에서는 그냥 연속적인 걸로 쳐도 아무 문제 없다.<small><del>(사실 이 세계는 디지털 시뮬레이션이었...)</del></small>

방금 설명에 등장한 `양자화`는 아날로그 오디오 신호를 디지털 오디오 신호로 변경할 때에도 같은 의미로 사용되기 때문에 기억해두자.
